-- [[ PHARMACII HUB - V9: TYRANT PURPLE THEME + SMART BYPASS (NO WHITELIST) ]] --

-- 1. Services & Player Setup
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local MyName = LocalPlayer.Name
local StarterGui = game:GetService("StarterGui")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Camera = workspace.CurrentCamera

print("PHARMACII: Initializing for " .. MyName .. "...")

-- 2. SMART BYPASS LOGIC (Runs Automatically)
local function ApplySmartBypass()
    -- Check for "Tech" game indicators
    local isTechGame = ReplicatedStorage:FindFirstChild("Values") or 
                       ReplicatedStorage:FindFirstChild("Handshake") or 
                       workspace:FindFirstChild("Values")

    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local ac = char:WaitForChild("LocalAntiCheat", 3)

    if ac then
        if isTechGame then
            -- CASE A: TECH GAME (Keep AC Alive)
            print("PHARMACII: Tech Game Detected. Catching Safe.")
            StarterGui:SetCore("SendNotification", {
                Title = "Smart Bypass",
                Text = "Tech Game Detected - AC Kept Alive",
                Duration = 3
            })
        else
            -- CASE B: OLD GAME (Destroy AC)
            print("PHARMACII: Old Game Detected. Destroying AC.")
            ac.Disabled = true
            ac:Destroy()
            StarterGui:SetCore("SendNotification", {
                Title = "Smart Bypass",
                Text = "Old Game Detected - Anti-Cheat Destroyed!",
                Duration = 3
            })
        end
    end
end

-- 3. Main Hub Function
local function LoadHub()
    task.spawn(ApplySmartBypass)
    LocalPlayer.CharacterAdded:Connect(function()
        task.wait(1)
        ApplySmartBypass()
    end)

    print("PHARMACII: Loading UI...")

    local Connections = {}

    local function AddConnection(signal, callback)
        local connection = signal:Connect(callback)
        table.insert(Connections, connection)
        return connection
    end

    -- Lighting Backups
    local OriginalTime = game:GetService("Lighting").ClockTime
    local OriginalBrightness = game:GetService("Lighting").Brightness

    -- Global Settings
    _G.HideKey = Enum.KeyCode.LeftControl
    _G.MagRange = 25 
    _G.TuckSpeed = 100
    _G.WalkSpeed = 16
    _G.JumpPower = 50
    _G.InfiniteJump = false
    _G.CustomTime = 12
    _G.CustomBright = 2
    _G.QBPrediction = 10
    _G.HBESize = 5

    -- Toggles
    local MagnetEnabled = false
    local VisualsEnabled = false
    local AutoTuckEnabled = false
    local NoclipEnabled = false
    local BlockEnabled = false
    local SpeedEnabled = false
    local PowerEnabled = false
    local QBFollowEnabled = false
    local TruckEnabled = false
    local AntiKnockEnabled = false
    local BigHeadEnabled = false
    local ShowHBEnabled = false
    local AutoTackleEnabled = false
    local QBAimEnabled = false
    local HBEEnabled = false
    local IsFollowing = false
    local CanDrag = true
    local CurrentTab = nil
    local TruckingHeld = false
    local MagnetCooldown = 0
    local MagnetLatchTime = 0.5
    local FeatureTable = {}
    
    -- [[ THEME UPDATE: TYRANT PURPLE ]] --
    local ThemeColor = Color3.fromRGB(130, 70, 255) -- Deep Electric Purple (Matches Image 2)
    local DarkBG = Color3.fromRGB(8, 8, 10)         -- Pitch Black/Deep Grey Background
    local ElementBG = Color3.fromRGB(18, 18, 22)    -- Slightly lighter for buttons

    -- GUI Parent Check
    local GuiParent = game:GetService("CoreGui")
    pcall(function()
        if not GuiParent:FindFirstChild("RobloxGui") then
            GuiParent = LocalPlayer:WaitForChild("PlayerGui")
        end
    end)

    if GuiParent:FindFirstChild("PharmaciiHub_Master") then
        GuiParent.PharmaciiHub_Master:Destroy()
    end

    -- Create GUI
    local ScreenGui = Instance.new("ScreenGui", GuiParent)
    ScreenGui.Name = "PharmaciiHub_Master"
    ScreenGui.ResetOnSpawn = false

    local SelectionBox = Instance.new("SelectionBox", GuiParent)
    SelectionBox.Name = "PharmaciiVisuals"
    SelectionBox.Color3 = ThemeColor
    SelectionBox.LineThickness = 0.05

    local MagPart = Instance.new("Part", workspace)
    MagPart.Name = "PharmaciiMagBox"
    MagPart.Transparency = 1
    MagPart.Anchored = true
    MagPart.CanCollide = false
    MagPart.CanQuery = false
    MagPart.CanTouch = false
    MagPart.Massless = true

    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.new(0, 800, 0, 480)
    MainFrame.Position = UDim2.new(0.5, -400, 0.5, -240)
    MainFrame.BackgroundColor3 = DarkBG -- Updated Background
    MainFrame.BorderSizePixel = 0
    MainFrame.Visible = true
    Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 6)

    -- Cleanup Function
    local function Cleanup()
        for _, connection in pairs(Connections) do
            if connection then connection:Disconnect() end
        end
        Connections = {}
        if MagPart then MagPart:Destroy() end
        if SelectionBox then SelectionBox:Destroy() end
        
        if LocalPlayer.Character then
            local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
            local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if hum then
                hum.WalkSpeed = 16
                hum.JumpPower = 50
            end
            if hrp then hrp.AssemblyLinearVelocity = Vector3.zero end
            for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = true end
            end
            local hb = LocalPlayer.Character:FindFirstChild("Hitbox") or LocalPlayer.Character:FindFirstChild("Jersey")
            if hb then hb.Size = Vector3.new(2.31, 5.4, 2.3) end
        end

        for _, plr in pairs(game.Players:GetPlayers()) do
            if plr.Character then
                local head = plr.Character:FindFirstChild("Head")
                if head then
                    head.Size = Vector3.new(2, 1, 1)
                    head.Transparency = 0
                end
                local jersey = plr.Character:FindFirstChild("Jersey") or plr.Character:FindFirstChild("Hitbox")
                if jersey then
                    jersey.Size = Vector3.new(2.31, 5.4, 2.3)
                    jersey.Transparency = 1
                end
            end
        end

        game:GetService("Lighting").ClockTime = OriginalTime
        game:GetService("Lighting").Brightness = OriginalBrightness
        if ScreenGui then ScreenGui:Destroy() end
    end

    -- Toggle Button
    local ToggleFrame = Instance.new("Frame", ScreenGui)
    ToggleFrame.Size = UDim2.new(0, 50, 0, 50)
    ToggleFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
    ToggleFrame.BackgroundColor3 = ElementBG
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Visible = UserInputService.TouchEnabled
    Instance.new("UICorner", ToggleFrame).CornerRadius = UDim.new(0, 8)
    local ToggleStroke = Instance.new("UIStroke", ToggleFrame)
    ToggleStroke.Color = ThemeColor
    ToggleStroke.Thickness = 2
    local ToggleBtn = Instance.new("TextButton", ToggleFrame)
    ToggleBtn.Size = UDim2.new(1, 0, 1, 0)
    ToggleBtn.BackgroundTransparency = 1
    ToggleBtn.Text = "P"
    ToggleBtn.TextColor3 = ThemeColor
    ToggleBtn.Font = "GothamBold"
    ToggleBtn.TextSize = 24
    
    AddConnection(ToggleBtn.MouseButton1Click, function()
        MainFrame.Visible = not MainFrame.Visible
    end)

    local dragging, dragStart, startPos
    AddConnection(ToggleFrame.InputBegan, function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = ToggleFrame.Position
        end
    end)
    AddConnection(ToggleFrame.InputChanged, function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            ToggleFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    AddConnection(ToggleFrame.InputEnded, function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)

    -- Notification Function
    local function SendNotify(title, text)
        if not ScreenGui.Parent then return end
        local nFrame = Instance.new("Frame", ScreenGui)
        nFrame.Size = UDim2.new(0, 220, 0, 50)
        nFrame.BackgroundColor3 = ElementBG
        nFrame.Position = UDim2.new(1, 10, 0.8, 0)
        Instance.new("UICorner", nFrame)
        local nStroke = Instance.new("UIStroke", nFrame)
        nStroke.Color = ThemeColor
        nStroke.Thickness = 1
        local nTitle = Instance.new("TextLabel", nFrame)
        nTitle.Text = title
        nTitle.Size = UDim2.new(1, -20, 0, 25)
        nTitle.Position = UDim2.new(0, 10, 0, 5)
        nTitle.TextColor3 = ThemeColor
        nTitle.Font = "GothamBold"
        nTitle.TextSize = 13
        nTitle.BackgroundTransparency = 1
        nTitle.TextXAlignment = "Left"
        local nText = Instance.new("TextLabel", nFrame)
        nText.Text = text
        nText.Size = UDim2.new(1, -20, 0, 20)
        nText.Position = UDim2.new(0, 10, 0, 22)
        nText.TextColor3 = Color3.new(1, 1, 1)
        nText.Font = "Gotham"
        nText.TextSize = 10
        nText.BackgroundTransparency = 1
        nText.TextXAlignment = "Left"
        TweenService:Create(nFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back), {Position = UDim2.new(1, -230, 0.8, 0)}):Play()
        task.delay(3, function()
            if nFrame and nFrame.Parent then
                TweenService:Create(nFrame, TweenInfo.new(0.4), {Position = UDim2.new(1, 10, 0.8, 0)}):Play()
                task.wait(0.5)
                if nFrame then nFrame:Destroy() end
            end
        end)
    end

    -- Log Console
    local LogFrame = Instance.new("ScrollingFrame", MainFrame)
    LogFrame.Name = "LogConsole"
    LogFrame.Size = UDim2.new(1, -240, 0, 80)
    LogFrame.Position = UDim2.new(0, 230, 1, -95)
    LogFrame.BackgroundColor3 = ElementBG
    LogFrame.BorderSizePixel = 0
    LogFrame.ScrollBarThickness = 2
    Instance.new("UICorner", LogFrame)
    local LogLayout = Instance.new("UIListLayout", LogFrame)
    LogLayout.Padding = UDim.new(0, 2)

    local function Log(text)
        if not LogFrame.Parent then return end
        local l = Instance.new("TextLabel", LogFrame)
        l.Size = UDim2.new(1, -10, 0, 18)
        l.BackgroundTransparency = 1
        l.TextColor3 = Color3.fromRGB(200, 200, 200)
        l.Font = "Code"
        l.TextSize = 11
        l.Text = " > " .. text
        l.TextXAlignment = "Left"
        LogFrame.CanvasSize = UDim2.new(0, 0, 0, LogLayout.AbsoluteContentSize.Y)
        LogFrame.CanvasPosition = Vector2.new(0, LogLayout.AbsoluteContentSize.Y)
    end

    -- Main UI Dragging
    local mainDragging, mainDragStart, mainStartPos
    AddConnection(MainFrame.InputBegan, function(input)
        if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) and CanDrag then
            mainDragging = true
            mainDragStart = input.Position
            mainStartPos = MainFrame.Position
        end
    end)
    AddConnection(UserInputService.InputChanged, function(input)
        if mainDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - mainDragStart
            MainFrame.Position = UDim2.new(mainStartPos.X.Scale, mainStartPos.X.Offset + delta.X, mainStartPos.Y.Scale, mainStartPos.Y.Offset + delta.Y)
        end
    end)
    AddConnection(UserInputService.InputEnded, function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            mainDragging = false
        end
    end)

    -- Header & Close Button
    local Header = Instance.new("Frame", MainFrame)
    Header.Size = UDim2.new(1, 0, 0, 40)
    Header.BackgroundTransparency = 1
    local Title = Instance.new("TextLabel", Header)
    Title.Text = "Pharmacii Hub"
    Title.TextColor3 = ThemeColor
    Title.Font = "GothamBold"
    Title.TextSize = 16
    Title.Size = UDim2.new(0, 200, 1, 0)
    Title.Position = UDim2.new(0, 30, 0, 0)
    Title.TextXAlignment = "Left"
    Title.BackgroundTransparency = 1
    local CloseBtn = Instance.new("TextButton", Header)
    CloseBtn.Size = UDim2.new(0, 24, 0, 24)
    CloseBtn.Position = UDim2.new(1, -34, 0, 8)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    CloseBtn.Text = "X"
    CloseBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
    CloseBtn.Font = "GothamBold"
    CloseBtn.TextSize = 14
    Instance.new("UICorner", CloseBtn).CornerRadius = UDim.new(0, 4)
    AddConnection(CloseBtn.MouseButton1Click, Cleanup)

    -- Sidebar & Search
    local Sidebar = Instance.new("Frame", MainFrame)
    Sidebar.Size = UDim2.new(0, 220, 1, -40)
    Sidebar.Position = UDim2.new(0, 0, 0, 40)
    Sidebar.BackgroundTransparency = 1
    
    local SearchFrame = Instance.new("Frame", Sidebar)
    SearchFrame.Size = UDim2.new(0, 190, 0, 32)
    SearchFrame.Position = UDim2.new(0.5, -95, 0, 10)
    SearchFrame.BackgroundColor3 = ElementBG
    Instance.new("UICorner", SearchFrame).CornerRadius = UDim.new(0, 6)
    local SearchIcon = Instance.new("ImageLabel", SearchFrame)
    SearchIcon.Size = UDim2.new(0, 16, 0, 16)
    SearchIcon.Position = UDim2.new(0, 10, 0.5, -8)
    SearchIcon.BackgroundTransparency = 1
    SearchIcon.Image = "rbxassetid://6031154871"
    SearchIcon.ImageColor3 = ThemeColor
    SearchIcon.ImageTransparency = 0.3
    local SearchBox = Instance.new("TextBox", SearchFrame)
    SearchBox.Size = UDim2.new(1, -35, 1, 0)
    SearchBox.Position = UDim2.new(0, 32, 0, 0)
    SearchBox.BackgroundTransparency = 1
    SearchBox.TextColor3 = Color3.new(1, 1, 1)
    SearchBox.PlaceholderText = "Search features..."
    SearchBox.Font = "Gotham"
    SearchBox.TextSize = 12
    SearchBox.PlaceholderColor3 = Color3.fromRGB(80, 80, 80)
    SearchBox.TextXAlignment = "Left"

    -- Profile Section
    local ProfileFrame = Instance.new("Frame", Sidebar)
    ProfileFrame.Size = UDim2.new(1, -20, 0, 50)
    ProfileFrame.Position = UDim2.new(0, 10, 1, -60)
    ProfileFrame.BackgroundColor3 = ElementBG
    Instance.new("UICorner", ProfileFrame).CornerRadius = UDim.new(0, 6)
    local pStroke = Instance.new("UIStroke", ProfileFrame)
    pStroke.Color = Color3.fromRGB(30, 30, 35)
    pStroke.Thickness = 1
    local pImage = Instance.new("ImageLabel", ProfileFrame)
    pImage.Size = UDim2.new(0, 34, 0, 34)
    pImage.Position = UDim2.new(0, 8, 0.5, -17)
    pImage.BackgroundTransparency = 1
    Instance.new("UICorner", pImage).CornerRadius = UDim.new(1, 0)
    task.spawn(function()
        pImage.Image = game:GetService("Players"):GetUserThumbnailAsync(LocalPlayer.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420)
    end)
    local pName = Instance.new("TextLabel", ProfileFrame)
    pName.Text = LocalPlayer.DisplayName
    pName.Size = UDim2.new(1, -55, 0, 18)
    pName.Position = UDim2.new(0, 50, 0, 8)
    pName.TextColor3 = Color3.new(1, 1, 1)
    pName.Font = "GothamBold"
    pName.TextSize = 12
    pName.TextXAlignment = "Left"
    pName.BackgroundTransparency = 1
    local pUser = Instance.new("TextLabel", ProfileFrame)
    pUser.Text = "@" .. LocalPlayer.Name
    pUser.Size = UDim2.new(1, -55, 0, 15)
    pUser.Position = UDim2.new(0, 50, 0, 24)
    pUser.TextColor3 = Color3.fromRGB(150, 150, 155)
    pUser.Font = "Gotham"
    pUser.TextSize = 10
    pUser.TextXAlignment = "Left"
    pUser.BackgroundTransparency = 1

    -- Tab Scroller
    local TabScroll = Instance.new("ScrollingFrame", Sidebar)
    TabScroll.Size = UDim2.new(1, 0, 1, -210)
    TabScroll.Position = UDim2.new(0, 0, 0, 55)
    TabScroll.BackgroundTransparency = 1
    TabScroll.ScrollBarThickness = 0
    local TabLayout = Instance.new("UIListLayout", TabScroll)
    TabLayout.Padding = UDim.new(0, 5)
    TabLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- Pages Container
    local PagesContainer = Instance.new("Frame", MainFrame)
    PagesContainer.Size = UDim2.new(1, -240, 1, -160)
    PagesContainer.Position = UDim2.new(0, 230, 0, 50)
    PagesContainer.BackgroundTransparency = 1

    local function CreateTab(Name, SubText, IconId, IsSettings)
        local Page = Instance.new("ScrollingFrame", PagesContainer)
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.Visible = false
        Page.BackgroundTransparency = 1
        Page.ScrollBarThickness = 0
        Instance.new("UIListLayout", Page).Padding = UDim.new(0, 10)

        local TabBtn = Instance.new("TextButton")
        TabBtn.Size = UDim2.new(0, 200, 0, 50)
        TabBtn.BackgroundColor3 = ElementBG
        TabBtn.Text = ""
        Instance.new("UICorner", TabBtn)
        TabBtn.Name = Name
        local TabIcon = Instance.new("ImageLabel", TabBtn)
        TabIcon.Size = UDim2.new(0, 24, 0, 24)
        TabIcon.Position = UDim2.new(0, 12, 0.5, -12)
        TabIcon.BackgroundTransparency = 1
        TabIcon.Image = "rbxthumb://type=Asset&id=" .. tostring(IconId) .. "&w=420&h=420"
        TabIcon.ImageColor3 = ThemeColor
        TabIcon.ZIndex = 5
        local TabTitle = Instance.new("TextLabel", TabBtn)
        TabTitle.Text = Name
        TabTitle.Size = UDim2.new(1, -55, 0, 25)
        TabTitle.Position = UDim2.new(0, 45, 0, 5)
        TabTitle.TextColor3 = Color3.new(1, 1, 1)
        TabTitle.Font = "GothamBold"
        TabTitle.TextSize = 13
        TabTitle.TextXAlignment = "Left"
        TabTitle.BackgroundTransparency = 1
        local TabSub = Instance.new("TextLabel", TabBtn)
        TabSub.Text = SubText
        TabSub.Size = UDim2.new(1, -55, 0, 15)
        TabSub.Position = UDim2.new(0, 45, 0, 23)
        TabSub.TextColor3 = Color3.fromRGB(150, 150, 155)
        TabSub.Font = "Gotham"
        TabSub.TextSize = 10
        TabSub.TextXAlignment = "Left"
        TabSub.BackgroundTransparency = 1

        TabBtn.Parent = IsSettings and Sidebar or TabScroll
        if IsSettings then
            TabBtn.Position = UDim2.new(0.5, -100, 1, -115)
        end

        AddConnection(TabBtn.MouseButton1Click, function()
            if CurrentTab then
                TweenService:Create(CurrentTab, TweenInfo.new(0.2), {BackgroundColor3 = ElementBG}):Play()
            end
            CurrentTab = TabBtn
            TweenService:Create(TabBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(35, 35, 38)}):Play()
            for _, p in pairs(PagesContainer:GetChildren()) do
                if p:IsA("ScrollingFrame") then p.Visible = false end
            end
            Page.Visible = true
        end)
        return Page
    end

    local TabCatch = CreateTab("Catching", "Magnets, etc", 111445466690589)
    local TabPhys = CreateTab("Physics", "Blocking, etc", 120444841204590)
    local TabAuto = CreateTab("Automatics", "Rush, guard", 125394931343127)
    local TabPlayer = CreateTab("Player", "Jumppower, etc", 76096928624044)
    local TabThrow = CreateTab("Throwing", "QB, etc", 88473943240732)
    local TabMisc = CreateTab("Misc", "No Bounds, etc", 123728818726021)
    local TabSettings = CreateTab("Settings", "Configuration", 96926477160025, true)

    AddConnection(SearchBox:GetPropertyChangedSignal("Text"), function()
        local txt = string.lower(SearchBox.Text)
        for _, btn in pairs(TabScroll:GetChildren()) do
            if btn:IsA("TextButton") then
                local sub = btn:FindFirstChildOfClass("TextLabel") and btn:FindFirstChildOfClass("TextLabel").Text or ""
                btn.Visible = string.find(string.lower(btn.Name), txt) or string.find(string.lower(sub), txt)
            end
        end
    end)

    local function CreateMagnetUI(page)
        local frame = Instance.new("Frame", page)
        frame.Size = UDim2.new(1, -20, 0, 60)
        frame.BackgroundColor3 = ElementBG
        frame.ClipsDescendants = true
        Instance.new("UICorner", frame)
        local lbl = Instance.new("TextLabel", frame)
        lbl.Text = "Ball Magnet"
        lbl.Size = UDim2.new(0.6, 0, 0, 60)
        lbl.Position = UDim2.new(0, 20, 0, 0)
        lbl.TextColor3 = Color3.new(1, 1, 1)
        lbl.Font = "GothamBold"
        lbl.TextSize = 13
        lbl.TextXAlignment = "Left"
        lbl.BackgroundTransparency = 1
        local btn = Instance.new("TextButton", frame)
        btn.Size = UDim2.new(0, 36, 0, 18)
        btn.Position = UDim2.new(1, -50, 0, 21)
        btn.BackgroundColor3 = Color3.fromRGB(45, 45, 48)
        btn.Text = ""
        Instance.new("UICorner", btn).CornerRadius = UDim.new(1, 0)
        local dot = Instance.new("Frame", btn)
        dot.Size = UDim2.new(0, 14, 0, 14)
        dot.Position = UDim2.new(0, 2, 0.5, -7)
        dot.BackgroundColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", dot).CornerRadius = UDim.new(1, 0)
        local extra = Instance.new("Frame", frame)
        extra.Size = UDim2.new(1, -40, 0, 100)
        extra.Position = UDim2.new(0, 20, 0, 60)
        extra.BackgroundTransparency = 1
        local rngLbl = Instance.new("TextLabel", extra)
        rngLbl.Text = "Catch Range: " .. _G.MagRange
        rngLbl.Size = UDim2.new(1, 0, 0, 15)
        rngLbl.TextColor3 = Color3.fromRGB(150, 150, 155)
        rngLbl.Font = "Gotham"
        rngLbl.TextSize = 11
        rngLbl.BackgroundTransparency = 1
        rngLbl.TextXAlignment = "Left"
        local slideBg = Instance.new("Frame", extra)
        slideBg.Size = UDim2.new(1, 0, 0, 6)
        slideBg.Position = UDim2.new(0, 0, 0, 25)
        slideBg.BackgroundColor3 = Color3.fromRGB(40, 40, 42)
        Instance.new("UICorner", slideBg)
        local slideFill = Instance.new("Frame", slideBg)
        slideFill.Size = UDim2.new(_G.MagRange / 500, 0, 1, 0) -- FIXED 500
        slideFill.BackgroundColor3 = ThemeColor
        Instance.new("UICorner", slideFill)
        local hbBtn = Instance.new("TextButton", extra)
        hbBtn.Size = UDim2.new(0, 30, 0, 15)
        hbBtn.Position = UDim2.new(1, -30, 0, 52)
        hbBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 48)
        hbBtn.Text = ""
        Instance.new("UICorner", hbBtn).CornerRadius = UDim.new(1, 0)
        local hbDot = Instance.new("Frame", hbBtn)
        hbDot.Size = UDim2.new(0, 11, 0, 11)
        hbDot.Position = UDim2.new(0, 2, 0.5, -5.5)
        hbDot.BackgroundColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", hbDot).CornerRadius = UDim.new(1, 0)
        local hbLbl = Instance.new("TextLabel", extra)
        hbLbl.Text = "Show Hitboxes"
        hbLbl.Size = UDim2.new(0, 100, 0, 15)
        hbLbl.Position = UDim2.new(1, -135, 0, 52)
        hbLbl.TextColor3 = Color3.fromRGB(150, 150, 155)
        hbLbl.Font = "Gotham"
        hbLbl.TextSize = 11
        hbLbl.BackgroundTransparency = 1
        hbLbl.TextXAlignment = "Right"

        local function ToggleMag(state)
            MagnetEnabled = state
            TweenService:Create(frame, TweenInfo.new(0.3), {Size = UDim2.new(1, -20, 0, MagnetEnabled and 150 or 60)}):Play()
            TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = MagnetEnabled and ThemeColor or Color3.fromRGB(45, 45, 48)}):Play()
            TweenService:Create(dot, TweenInfo.new(0.2), {Position = MagnetEnabled and UDim2.new(1, -17, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)}):Play()
            SendNotify("Magnet", MagnetEnabled and "Enabled" or "Disabled")
        end

        AddConnection(slideBg.InputBegan, function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                CanDrag = false
                local move = AddConnection(UserInputService.InputChanged, function(m)
                    if m.UserInputType == Enum.UserInputType.MouseMovement or m.UserInputType == Enum.UserInputType.Touch then
                        local scale = math.clamp((m.Position.X - slideBg.AbsolutePosition.X) / slideBg.AbsoluteSize.X, 0, 1)
                        slideFill.Size = UDim2.new(scale, 0, 1, 0)
                        _G.MagRange = math.floor(scale * 500) -- FIXED 500
                        rngLbl.Text = "Catch Range: " .. _G.MagRange
                    end
                end)
                local release
                release = AddConnection(UserInputService.InputEnded, function(k)
                    if k.UserInputType == Enum.UserInputType.MouseButton1 or k.UserInputType == Enum.UserInputType.Touch then
                        move:Disconnect()
                        release:Disconnect()
                        CanDrag = true
                    end
                end)
            end
        end)

        AddConnection(btn.MouseButton1Click, function() ToggleMag(not MagnetEnabled) end)
        AddConnection(hbBtn.MouseButton1Click, function()
            VisualsEnabled = not VisualsEnabled
            TweenService:Create(hbBtn, TweenInfo.new(0.2), {BackgroundColor3 = VisualsEnabled and ThemeColor or Color3.fromRGB(45, 45, 48)}):Play()
            TweenService:Create(hbDot, TweenInfo.new(0.2), {Position = VisualsEnabled and UDim2.new(1, -14, 0.5, -5.5) or UDim2.new(0, 2, 0.5, -5.5)}):Play()
            SendNotify("Hitboxes", VisualsEnabled and "Shown" or "Hidden")
        end)

        FeatureTable["Magnet"] = {
            SetState = function(s) if s ~= MagnetEnabled then ToggleMag(s) end end,
            GetState = function() return MagnetEnabled end,
            SetValue = function(v) _G.MagRange = v; rngLbl.Text = "Catch Range: " .. v; slideFill.Size = UDim2.new(v / 500, 0, 1, 0) end,
            GetValue = function() return _G.MagRange end
        }
    end

    local function CreateButton(page, name, callback)
        local frame = Instance.new("Frame", page)
        frame.Size = UDim2.new(1, -20, 0, 50)
        frame.BackgroundColor3 = ElementBG
        Instance.new("UICorner", frame)
        local lbl = Instance.new("TextLabel", frame)
        lbl.Text = name
        lbl.Size = UDim2.new(0.6, 0, 1, 0)
        lbl.Position = UDim2.new(0, 20, 0, 0)
        lbl.TextColor3 = Color3.new(1, 1, 1)
        lbl.Font = "GothamBold"
        lbl.TextSize = 13
        lbl.TextXAlignment = "Left"
        lbl.BackgroundTransparency = 1
        local btn = Instance.new("TextButton", frame)
        btn.Size = UDim2.new(0, 100, 0, 30)
        btn.Position = UDim2.new(1, -110, 0.5, -15)
        btn.BackgroundColor3 = Color3.fromRGB(45, 45, 48)
        btn.Text = "Click"
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = "GothamBold"
        btn.TextSize = 11
        Instance.new("UICorner", btn)
        AddConnection(btn.MouseButton1Click, function()
            TweenService:Create(btn, TweenInfo.new(0.1), {BackgroundColor3 = ThemeColor}):Play()
            task.wait(0.1)
            TweenService:Create(btn, TweenInfo.new(0.1), {BackgroundColor3 = Color3.fromRGB(45, 45, 48)}):Play()
            callback(btn)
        end)
    end

    local function CreateToggle(page, name, label, hasSlider, default, max, key, callback)
        local frame = Instance.new("Frame", page)
        frame.Size = UDim2.new(1, -20, 0, 60)
        frame.BackgroundColor3 = ElementBG
        frame.ClipsDescendants = true
        Instance.new("UICorner", frame)
        local txt = Instance.new("TextLabel", frame)
        txt.Text = name
        txt.Size = UDim2.new(0.6, 0, 0, 60)
        txt.Position = UDim2.new(0, 20, 0, 0)
        txt.TextColor3 = Color3.new(1, 1, 1)
        txt.Font = "GothamBold"
        txt.TextSize = 13
        txt.TextXAlignment = "Left"
        txt.BackgroundTransparency = 1
        local btn = Instance.new("TextButton", frame)
        btn.Size = UDim2.new(0, 36, 0, 18)
        btn.Position = UDim2.new(1, -50, 0, 21)
        btn.BackgroundColor3 = Color3.fromRGB(45, 45, 48)
        btn.Text = ""
        Instance.new("UICorner", btn).CornerRadius = UDim.new(1, 0)
        local dot = Instance.new("Frame", btn)
        dot.Size = UDim2.new(0, 14, 0, 14)
        dot.Position = UDim2.new(0, 2, 0.5, -7)
        dot.BackgroundColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", dot).CornerRadius = UDim.new(1, 0)

        local currentVal = default
        local updateVal = nil

        if hasSlider then
            local sFrame = Instance.new("Frame", frame)
            sFrame.Size = UDim2.new(1, -40, 0, 40)
            sFrame.Position = UDim2.new(0, 20, 0, 60)
            sFrame.BackgroundTransparency = 1
            local sLbl = Instance.new("TextLabel", sFrame)
            sLbl.Text = label .. ": " .. default
            sLbl.Size = UDim2.new(1, 0, 0, 15)
            sLbl.TextColor3 = Color3.fromRGB(150, 150, 155)
            sLbl.Font = "Gotham"
            sLbl.TextSize = 11
            sLbl.BackgroundTransparency = 1
            sLbl.TextXAlignment = "Left"
            local sBg = Instance.new("Frame", sFrame)
            sBg.Size = UDim2.new(1, 0, 0, 6)
            sBg.Position = UDim2.new(0, 0, 0, 25)
            sBg.BackgroundColor3 = Color3.fromRGB(40, 40, 42)
            Instance.new("UICorner", sBg)
            local sFill = Instance.new("Frame", sBg)
            sFill.Size = UDim2.new(default / max, 0, 1, 0)
            sFill.BackgroundColor3 = ThemeColor
            Instance.new("UICorner", sFill)

            updateVal = function(v)
                currentVal = v
                sFill.Size = UDim2.new(v / max, 0, 1, 0)
                sLbl.Text = label .. ": " .. v
                
                if key == "Time" then _G.CustomTime = v; if FeatureTable[key] and FeatureTable[key].GetState() then game:GetService("Lighting").ClockTime = v end
                elseif key == "Bright" then _G.CustomBright = v; if FeatureTable[key] and FeatureTable[key].GetState() then game:GetService("Lighting").Brightness = v end
                elseif key == "Predict" then _G.QBPrediction = v
                elseif key == "HBE" then _G.HBESize = v
                else callback(v) end
            end

            AddConnection(sBg.InputBegan, function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    CanDrag = false
                    local move = AddConnection(UserInputService.InputChanged, function(m)
                        if m.UserInputType == Enum.UserInputType.MouseMovement or m.UserInputType == Enum.UserInputType.Touch then
                            local scale = math.clamp((m.Position.X - sBg.AbsolutePosition.X) / sBg.AbsoluteSize.X, 0, 1)
                            local val = math.floor(scale * max)
                            updateVal(val)
                        end
                    end)
                    local release
                    release = AddConnection(UserInputService.InputEnded, function(k)
                        if k.UserInputType == Enum.UserInputType.MouseButton1 or k.UserInputType == Enum.UserInputType.Touch then
                            move:Disconnect()
                            release:Disconnect()
                            CanDrag = true
                        end
                    end)
                end
            end)
        end

        local enabled = false
        local function ToggleState(state)
            enabled = state
            
            if key == "Tuck" then AutoTuckEnabled = enabled
            elseif key == "HBE" then HBEEnabled = enabled
            elseif key == "Block" then 
                BlockEnabled = enabled
                if not enabled then 
                    for _, p in pairs(game.Players:GetPlayers()) do 
                        if p ~= LocalPlayer and p.Character then
                            local j = p.Character:FindFirstChild("Jersey") or p.Character:FindFirstChild("Hitbox")
                            if j then j.Size = Vector3.new(2.31, 5.4, 2.3) end
                        end 
                    end 
                end
            elseif key == "InfJump" then _G.InfiniteJump = enabled
            elseif key == "Noclip" then 
                NoclipEnabled = enabled
                if not enabled and LocalPlayer.Character then
                    for _, v in pairs({"Head","HumanoidRootPart","UpperTorso","LowerTorso","Torso"}) do
                        local part = LocalPlayer.Character:FindFirstChild(v)
                        if part then part.CanCollide = true end
                    end
                end
            elseif key == "Speed" then 
                SpeedEnabled = enabled
                if not enabled and LocalPlayer.Character then LocalPlayer.Character.Humanoid.WalkSpeed = 16 end
            elseif key == "Power" then 
                PowerEnabled = enabled
                if not enabled and LocalPlayer.Character then LocalPlayer.Character.Humanoid.JumpPower = 50 end
            elseif key == "QBFollow" then 
                QBFollowEnabled = enabled
                if not enabled then IsFollowing = false end
            elseif key == "Truck" then TruckEnabled = enabled
            elseif key == "AntiKnock" then 
                AntiKnockEnabled = enabled
                if not enabled and LocalPlayer.Character then
                    local l, r = LocalPlayer.Character:FindFirstChild("Left Arm"), LocalPlayer.Character:FindFirstChild("Right Arm")
                    if l then l.Size = Vector3.new(1,2,1) end
                    if r then r.Size = Vector3.new(1,2,1) end
                end
            elseif key == "BigHead" then 
                BigHeadEnabled = enabled
                if not enabled then
                    for _, p in pairs(game.Players:GetPlayers()) do
                        if p.Character and p.Character:FindFirstChild("Head") then
                            p.Character.Head.Size = Vector3.new(2,1,1)
                            p.Character.Head.Transparency = 0
                        end
                    end
                end
            elseif key == "ShowHB" then 
                ShowHBEnabled = enabled
                if not enabled then
                    for _, p in pairs(game.Players:GetPlayers()) do
                        if p ~= LocalPlayer and p.Character then
                            local j = p.Character:FindFirstChild("Jersey") or p.Character:FindFirstChild("Hitbox")
                            if j then j.Transparency = 1 end
                        end
                    end
                end
            elseif key == "AutoTackle" then AutoTackleEnabled = enabled
            elseif key == "QBAim" then 
                QBAimEnabled = enabled
                if enabled then SendNotify("Info", "Hold Right Click to Aim") end
            elseif key == "Time" then game:GetService("Lighting").ClockTime = enabled and _G.CustomTime or OriginalTime
            elseif key == "Bright" then game:GetService("Lighting").Brightness = enabled and _G.CustomBright or OriginalBrightness
            end

            TweenService:Create(frame, TweenInfo.new(0.3), {Size = UDim2.new(1, -20, 0, enabled and hasSlider and 120 or 60)}):Play()
            TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = enabled and ThemeColor or Color3.fromRGB(45, 45, 48)}):Play()
            TweenService:Create(dot, TweenInfo.new(0.2), {Position = enabled and UDim2.new(1, -17, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)}):Play()
            
            SendNotify(name, enabled and "Enabled" or "Disabled")
        end

        AddConnection(btn.MouseButton1Click, function() ToggleState(not enabled) end)
        FeatureTable[key] = {
            SetState = ToggleState,
            GetState = function() return enabled end,
            SetValue = updateVal,
            GetValue = function() return currentVal end
        }
    end

    local ConfigFile = "PharmaciiConfig.json"
    local function SaveCfg()
        if not writefile then SendNotify("Error", "Executor not supported"); return end
        local data = {}
        for k, v in pairs(FeatureTable) do
            data[k] = {Enabled = v.GetState(), Value = v.GetValue and v.GetValue() or 0}
        end
        writefile(ConfigFile, HttpService:JSONEncode(data))
        SendNotify("Config", "Saved Successfully")
    end

    local function LoadCfg()
        if not isfile or not readfile then SendNotify("Error", "Executor not supported"); return end
        if isfile(ConfigFile) then
            local data = HttpService:JSONDecode(readfile(ConfigFile))
            for k, v in pairs(data) do
                if FeatureTable[k] then
                    FeatureTable[k].SetState(v.Enabled)
                    if v.Value and FeatureTable[k].SetValue then FeatureTable[k].SetValue(v.Value) end
                end
            end
            SendNotify("Config", "Loaded Successfully")
        else
            SendNotify("Config", "No Save File Found")
        end
    end

    -- Build Features
    CreateMagnetUI(TabCatch)
    CreateToggle(TabCatch, "Auto Tuck", "Delay (ms)", true, 50, 500, "Tuck", function(v) _G.TuckSpeed = v end)
    
    CreateToggle(TabPhys, "Advanced Blocking", "Resize Enemies", false, 0, 0, "Block", function() end)
    CreateToggle(TabPhys, "Enhanced Trucking", "Press 'F'", false, 0, 0, "Truck", function() end)
    CreateToggle(TabPhys, "Anti-Knockback", "Expand Arms", false, 0, 0, "AntiKnock", function() end)
    CreateToggle(TabPhys, "Big Head All", "Expand Heads", false, 0, 0, "BigHead", function() end)
    
    CreateToggle(TabAuto, "QB Follow", "Press 'R' to toggle", false, 0, 0, "QBFollow", function() end)
    CreateToggle(TabAuto, "Auto Tackle", "Teleport to Ball", false, 0, 0, "AutoTackle", function() end)
    
    CreateToggle(TabThrow, "QB Aimbot", "Right Click", false, 0, 0, "QBAim", function() end)
    CreateToggle(TabThrow, "Prediction", "Lead Amount", true, 10, 50, "Predict", function(v) _G.QBPrediction = v end)
    
    CreateToggle(TabPlayer, "Walkspeed", "Speed", true, 16, 250, "Speed", function(v) _G.WalkSpeed = v end)
    CreateToggle(TabPlayer, "JumpPower", "Power", true, 50, 500, "Power", function(v) _G.JumpPower = v end)
    CreateToggle(TabPlayer, "Infinite Jump", "Air Walk", false, 0, 0, "InfJump", function() end)
    CreateToggle(TabPlayer, "Noclip", "No Walls", false, 0, 0, "Noclip", function() end)
    
    CreateToggle(TabMisc, "HBE (Self)", "Size", true, 5, 50, "HBE", function(v) _G.HBESize = v end)
    CreateToggle(TabMisc, "No Bounds", "Remove Walls", false, 0, 0, "NoBounds", function() end)
    
    CreateButton(TabSettings, "Infinite Yield", function() loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))() end)
    CreateButton(TabSettings, "Rejoin Server", function() TeleportService:Teleport(game.PlaceId, LocalPlayer) end)
    CreateToggle(TabSettings, "Visible All Hitboxes", "See Everyone", false, 0, 0, "ShowHB", function() end)
    CreateToggle(TabSettings, "World Time", "Clock Time", true, 12, 24, "Time", function(v) end)
    CreateToggle(TabSettings, "Brightness", "Light Level", true, 2, 10, "Bright", function(v) end)
    CreateButton(TabSettings, "Save Config", SaveCfg)
    CreateButton(TabSettings, "Load Config", LoadCfg)

    local KeybindActive = false
    local KeybindBtn = nil
    CreateButton(TabSettings, "Change UI Keybind", function(b)
        KeybindActive = true
        KeybindBtn = b
        b.Text = "Press Key..."
    end)

    AddConnection(UserInputService.InputBegan, function(input)
        if KeybindActive and input.UserInputType == Enum.UserInputType.Keyboard then
            _G.HideKey = input.KeyCode
            KeybindActive = false
            if KeybindBtn then KeybindBtn.Text = "Bind: " .. input.KeyCode.Name end
            SendNotify("Keybind", "Set to " .. input.KeyCode.Name)
        end
    end)

    AddConnection(UserInputService.InputBegan, function(input, g)
        if not g and (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
            local char = LocalPlayer.Character
            local ball = char and (char:FindFirstChild("Football") or char:FindFirstChild("Ball"))
            if not ball then MagnetCooldown = tick() + MagnetLatchTime end
        end
    end)

    local tucked = false
    task.spawn(function()
        while ScreenGui.Parent do
            if AutoTuckEnabled then
                local char = LocalPlayer.Character
                if char then
                    local ball = char:FindFirstChild("Football") or char:FindFirstChild("Ball")
                    if ball then
                        if not tucked then
                            task.wait(_G.TuckSpeed / 1000)
                            pcall(function()
                                VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
                                task.wait(0.05)
                                VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
                            end)
                            tucked = true
                            Log("Auto Tuck Executed")
                        end
                    else
                        tucked = false
                    end
                else
                    task.wait(0.5)
                end
            else
                task.wait(0.5)
            end
            task.wait(0.1)
        end
    end)

    AddConnection(RunService.RenderStepped, function()
        local char = LocalPlayer.Character
        if not char then return end

        if MagnetEnabled then
            local ball = char:FindFirstChild("Football") or char:FindFirstChild("Ball")
            if not ball then
                local isCatching = tick() < MagnetCooldown or UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) or UserInputService:IsGamepadButtonDown(Enum.UserInputType.Gamepad1, Enum.KeyCode.ButtonR2)
                local hand = char:FindFirstChild("RightHand") or char:FindFirstChild("Right Arm")
                if isCatching and hand then
                    for _, obj in pairs(workspace:GetChildren()) do
                        if (obj.Name == "Football" or obj.Name == "Ball") and obj:IsA("BasePart") then
                            local dist = (obj.Position - hand.Position).Magnitude
                            if dist <= _G.MagRange then
                                pcall(function()
                                    obj.CanCollide = false
                                    obj.AssemblyLinearVelocity = Vector3.zero
                                    obj.AssemblyAngularVelocity = Vector3.zero
                                    obj.RotVelocity = Vector3.zero
                                    obj.CFrame = hand.CFrame * CFrame.new(0, -0.85, 0)
                                end)
                            end
                        end
                    end
                end
            end
        end

        if QBAimEnabled then
            local ball = char:FindFirstChild("Football") or char:FindFirstChild("Ball")
            if ball and UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
                local closest, dist = nil, math.huge
                local mouse = UserInputService:GetMouseLocation()
                for _, plr in pairs(game.Players:GetPlayers()) do
                    if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                        local screenPos, visible = Camera:WorldToViewportPoint(plr.Character.HumanoidRootPart.Position)
                        if visible then
                            local mag = (Vector2.new(mouse.X, mouse.Y) - Vector2.new(screenPos.X, screenPos.Y)).Magnitude
                            if mag < dist then closest = plr; dist = mag end
                        end
                    end
                end
                if closest then
                    local hrp = closest.Character.HumanoidRootPart
                    local pred = hrp.Position + hrp.Velocity * _G.QBPrediction / 100
                    Camera.CFrame = CFrame.lookAt(Camera.CFrame.Position, pred)
                end
            end
        end
    end)

    AddConnection(RunService.Heartbeat, function()
        local char = LocalPlayer.Character
        local hum = char and char:FindFirstChild("Humanoid")
        
        if hum then
            if SpeedEnabled and hum.WalkSpeed ~= _G.WalkSpeed then hum.WalkSpeed = _G.WalkSpeed end
            if PowerEnabled and hum.JumpPower ~= _G.JumpPower then hum.JumpPower = _G.JumpPower end
        end

        if NoclipEnabled and char then
            for _, v in pairs(char:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = false end
            end
        end

        if MagnetEnabled and VisualsEnabled and char and char:FindFirstChild("HumanoidRootPart") then
            MagPart.CFrame = char.HumanoidRootPart.CFrame
            MagPart.Size = Vector3.new(_G.MagRange, _G.MagRange, _G.MagRange)
            SelectionBox.Adornee = MagPart
        else
            SelectionBox.Adornee = nil
        end

        -- FIXED QB FOLLOW
        if IsFollowing and QBFollowEnabled then 
            local targetPos = nil
            local ball = workspace:FindFirstChild("Football") or workspace:FindFirstChild("Ball")
            if ball then 
                targetPos = ball.Position
            else
                for _, p in pairs(Players:GetPlayers()) do
                    if p.Character and (p.Character:FindFirstChild("Football") or p.Character:FindFirstChild("Ball")) then
                        targetPos = p.Character.HumanoidRootPart.Position
                        break
                    end
                end
            end
            if targetPos and hum then hum:MoveTo(targetPos) end
        end

        -- FIXED AUTO TACKLE
        if AutoTackleEnabled then 
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= LocalPlayer and p.Character then
                    if p.Character:FindFirstChild("Football") or p.Character:FindFirstChild("Ball") then
                        if char and char:FindFirstChild("HumanoidRootPart") and p.Character:FindFirstChild("HumanoidRootPart") then
                            char.HumanoidRootPart.CFrame = p.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 1)
                        end
                    end
                end
            end
        end

        if TruckEnabled and TruckingHeld and char then
            local val = char:FindFirstChild("Trucking", true)
            if val then val.Value = true end
        end

        if BlockEnabled then
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= LocalPlayer and p.Character then
                    local c = p.Character
                    local j = c:FindFirstChild("Jersey") or c:FindFirstChild("Hitbox")
                    if j then j.Size = Vector3.new(10, 10, 10) end
                end
            end
        end

        if HBEEnabled and char then
            local hb = char:FindFirstChild("Hitbox") or char:FindFirstChild("Jersey") or char:FindFirstChild("HumanoidRootPart")
            if hb then hb.Size = Vector3.new(_G.HBESize, _G.HBESize, _G.HBESize) end
        end

        if ShowHBEnabled then
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= LocalPlayer and p.Character then
                    local j = p.Character:FindFirstChild("Jersey") or p.Character:FindFirstChild("Hitbox")
                    if j then j.Transparency = 0.8 end
                end
            end
        end

        if AntiKnockEnabled and char then
            local l = char:FindFirstChild("Left Arm")
            local r = char:FindFirstChild("Right Arm")
            if l and r then l.Size = Vector3.new(20, 2, 2); r.Size = Vector3.new(20, 2, 2) end
        end

        if BigHeadEnabled then
            for _, p in pairs(game.Players:GetPlayers()) do
                if p.Character and p.Character:FindFirstChild("Head") then
                    p.Character.Head.Size = Vector3.new(4, 4, 4)
                    p.Character.Head.Transparency = 1
                end
            end
        end
    end)

    AddConnection(UserInputService.JumpRequest, function()
        if _G.InfiniteJump and LocalPlayer.Character then
            local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
            if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
        end
    end)

    AddConnection(UserInputService.InputBegan, function(input, g)
        if not g then
            if input.KeyCode == _G.HideKey then 
                MainFrame.Visible = not MainFrame.Visible
            elseif input.KeyCode == Enum.KeyCode.R and QBFollowEnabled then
                IsFollowing = not IsFollowing
                SendNotify("QB Follow", IsFollowing and "On" or "Off")
            elseif input.KeyCode == Enum.KeyCode.F and TruckEnabled then
                TruckingHeld = true
                local char = LocalPlayer.Character
                if char then
                    local jersey = char:FindFirstChild("Jersey")
                    if jersey then 
                        local evt = jersey:FindFirstChild("Event")
                        if evt then evt:FireServer({[1] = "Truck"}) end
                    end
                end
            end
        end
    end)

    AddConnection(UserInputService.InputEnded, function(input, g)
        if input.KeyCode == Enum.KeyCode.F and TruckEnabled then
            TruckingHeld = false
            local char = LocalPlayer.Character
            if char then
                local jersey = char:FindFirstChild("Jersey")
                if jersey then
                    local evt = jersey:FindFirstChild("Event")
                    if evt then evt:FireServer({[1] = "StopTruck"}) end
                end
                local val = char:FindFirstChild("Trucking", true)
                if val then val.Value = false end
            end
        end
    end)

    -- Show First Tab
    for _, p in pairs(PagesContainer:GetChildren()) do p.Visible = false end
    PagesContainer:GetChildren()[1].Visible = true
    Log("Pharmacii Hub: https://discord.gg/P3MaHnCRjN.")
end

-- 4. Run Script Directly (Whitelist Removed)
LoadHub()
